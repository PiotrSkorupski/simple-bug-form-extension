import"../../CommonImports";import"../../Core/core.css";import"./Table.css";import*as React from"react";import{ObservableValue}from"../../Core/Observable";import{Checkbox,TriStateCheckbox}from"../../Checkbox";import{Observer}from"../../Observer";import{css,preventDefault}from"../../Util";var ColumnSelect=function(){function e(){var e=this;this.columnLayout=0,this.id="_select",this.width=40,this.columnSelectBehavior={initialize:function(t){e.itemProvider=t.tableProps.itemProvider,e.selection=t.tableProps.selection},componentDidMount:function(t){e.componentDidMount(t)},componentDidUpdate:function(t){e.componentDidUpdate(t)},componentWillUnmount:function(){e.componentWillUnmount()}},this.allSelected=new ObservableValue(!1),this.behaviors=[this.columnSelectBehavior],this.renderCell=function(t,l,o){var n=e.selection,c=n&&n.selected(t);return React.createElement("td",{key:"col-select","aria-colindex":l,className:css("bolt-table-cell-select bolt-table-cell-compact bolt-table-cell bolt-list-cell","col-"+l),"data-column-index":l,onClick:preventDefault,onDoubleClick:preventDefault,onMouseDown:function(l){var o=e.selection;o&&(o.selected(t)?o.unselect(t):o.select(t,1,!0)),l.preventDefault()}},React.createElement("div",{className:css("flex-row justify-center")},React.createElement("span",{className:"flex-row-inline"},React.createElement(Checkbox,{checked:!!c,excludeTabStop:!0,excludeFocusZone:!0}))))},this.renderHeaderCell=function(t,l,o){return React.createElement("td",{key:"col-select",className:css("bolt-table-cell-select bolt-table-cell-compact bolt-table-header-cell","col-header-"+t),"data-column-index":t},React.createElement("div",{className:"flex-row"},React.createElement(Observer,{allSelected:e.allSelected},function(t){var l=e,n=l.itemProvider,c=l.selection,i=n&&n.length;return React.createElement("div",{className:"flex-row flex-grow justify-center"},c&&c.multiSelect&&-1!==i&&React.createElement(TriStateCheckbox,{checked:t.allSelected,focuszoneId:o,onChange:e.onChangeHeader}))})))},this.onChangeHeader=function(t){e.toggleSelectAll()},this.onSelectionChange=function(){var t=e,l=t.itemProvider,o=t.selection;if(o){var n=o.selectedCount,c=l&&l.length-o.unselectableCount;e.allSelected.value=n>0&&(n===c||void 0)}}}return e.prototype.componentDidMount=function(e){var t=this.selection;t&&(t.subscribe(this.onSelectionChange),this.onSelectionChange())},e.prototype.componentDidUpdate=function(e){var t=this.selection;t&&t!==e.tableProps.selection&&t.unsubscribe(this.onSelectionChange),t=e.tableProps.selection,this.selection=t,t&&(t.subscribe(this.onSelectionChange),this.onSelectionChange())},e.prototype.componentWillUnmount=function(){var e=this.selection;e&&e.unsubscribe(this.onSelectionChange)},e.prototype.toggleSelectAll=function(){var e=this.itemProvider,t=this.selection;t&&(!1!==this.allSelected.value?t.clear():t.select(0,e&&e.length))},e}();export{ColumnSelect};