import*as tslib_1 from"tslib";import"../../CommonImports";import"../../Core/core.css";import*as React from"react";import{shimRef}from"../../Util";var ResponsiveLayout=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=React.createRef(),t.hiddenCount=0,t.updateLayout=function(){var e=t.containerRef.current;if(e&&e.children.length){var i=t.hiddenCount,n=e.getBoundingClientRect(),o=0,r=0,l=!1;t.childDetails&&e.children.length===t.childDetails.length||(t.childDetails=[],l=!0);for(var d=0;d<e.children.length;d++){var a=e.children[d].getBoundingClientRect();l?t.childDetails.push({appliedSize:0,clientRect:a}):t.childDetails[d].clientRect=a,t.props.ignoredChildren&&t.props.ignoredChildren.indexOf(d)>=0&&(r+=1===t.props.orientation?a.height:a.width)}o=1===t.props.orientation?t.childDetails[t.childDetails.length-1].clientRect.bottom-t.childDetails[0].clientRect.top:t.childDetails[t.childDetails.length-1].clientRect.right-t.childDetails[0].clientRect.left,o-=Math.floor(r);var s=1===t.props.orientation?n.height:n.width;if(s<=o)for(u=s-o;u<0&&t.hiddenCount<t.props.responsiveChildren.length;){var c=t.props.responsiveChildren[t.hiddenCount],h=t.childDetails[c],p=1===t.props.orientation?h.clientRect.height:h.clientRect.width;u+=p,h.hidden=!0,h.appliedSize=p,t.hiddenCount++}else if(s>o)for(var u=s-o;t.hiddenCount>0;){var c=t.props.responsiveChildren[t.hiddenCount-1],h=t.childDetails[c];if(t.childDetails[c].appliedSize>=u)break;u-=h.appliedSize,h.hidden=!1,t.hiddenCount--}i!=t.hiddenCount&&(t.props.onLayoutChange&&t.props.onLayoutChange(t.hiddenCount),window.setTimeout(function(){t.forceUpdate()},0))}},t}return tslib_1.__extends(t,e),t.prototype.render=function(){var e=this,t=React.Children.only(this.props.children);return this.containerRef=shimRef(t),React.cloneElement(t,tslib_1.__assign({},t.props,{ref:this.containerRef}),React.Children.map(t.props.children,function(t,i){if("function"==typeof t)throw Error("Functional components aren't allowed as the direct child of a ResponsiveLayout container");return e.childDetails&&e.childDetails[i]&&e.childDetails[i].hidden?React.createElement("div",{key:"PH"+i,className:"responsive-placeholder"}):("string"!=typeof t&&"number"!=typeof t||(t=React.createElement("span",null,t)),t)}))},t.prototype.componentDidMount=function(){window.addEventListener("resize",this.updateLayout),this.updateLayout()},t.prototype.componentDidUpdate=function(){this.updateLayout()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateLayout)},t.prototype.resetLayout=function(){this.childDetails=void 0,this.hiddenCount=0},t}(React.Component);export{ResponsiveLayout};