import"../../CommonImports";import"../../Core/core.css";import"./List.css";import"./ListDropIndicator.css";import*as React from"react";import{beginDragOperation,DragImage}from"../../Utilities/DragDrop";import{cellFromEvent}from"./List";var ListDragSourceBehavior=function(){function e(e){var t=this;this.initialize=function(e,r,a){t.dragDroppableUI=r,t.eventDispatch=a,t.eventDispatch.addEventListener("mousedown",t.onMouseDown),t.eventDispatch.addEventListener("touchstart",t.onTouchStart),t.eventDispatch.addEventListener("dragstart",t.onDragStart),t.eventDispatch.addEventListener("dragend",t.onDragEnd),t.itemProvider=e.itemProvider},this.onDragEnd=function(e){cellFromEvent(e).rowIndex>=0&&t.options.onDragEnd&&t.options.onDragEnd(e),t.dragDroppableUI.removeOverlay("drag-source-item"),t.dragImageData=void 0},this.onDragStart=function(e){var r=cellFromEvent(e).rowIndex;r>=0&&(t.options.onDragStart&&t.options.onDragStart(e),"none"!==e.detail.dataTransfer.effectAllowed&&(t.dragDroppableUI.addOverlay("drag-source-item",r,t.renderDragSourceItemOverlay),void 0===t.dragImageData&&(t.dragImageData={image:t.options.renderDragImage(e)})))},this.onMouseDown=function(e){0===e.button&&t.beginDrag(e)},this.onTouchStart=function(e){t.beginDrag(e)},this.renderDragSourceItemOverlay=function(e){return React.createElement(React.Fragment,null,React.createElement("div",{className:"bolt-list-drag-source-item flex-grow"}),t.operation&&t.dragImageData&&React.createElement(DragImage,{operation:t.operation},t.dragImageData.image))},this.setDragImage=function(e,r,a){t.dragImageData={image:e,xOffset:r,yOffset:a}},this.options=e}return e.prototype.componentDidUpdate=function(e){this.itemProvider=e.itemProvider},e.prototype.componentWillUnmount=function(){this.eventDispatch.removeEventListener("mousedown",this.onMouseDown),this.eventDispatch.removeEventListener("dragstart",this.onDragStart),this.eventDispatch.removeEventListener("dragend",this.onDragEnd)},e.prototype.beginDrag=function(e){var t=cellFromEvent(e).rowIndex;if(this.itemProvider&&t>=0){var r=this.itemProvider.value[t];this.operation=beginDragOperation(e,{data:r,dropEffect:"none",secondaryData:{index:t,sourceId:this.options.id},setDragImage:this.setDragImage,type:this.options.type})}},e}();export{ListDragSourceBehavior};