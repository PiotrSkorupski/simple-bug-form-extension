import*as tslib_1 from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./IdentityCard.css";import*as React from"react";import*as Resources from"../../Resources.Persona";import{Callout}from"../../Callout";import{FocusZone}from"../../FocusZone";import{Spinner}from"../../Spinner";import{css}from"../../Util";import{ContactCard}from"./ContactCard";import{DefaultAbridgedCard}from"./DefaultAbridgedCard";import{DefaultCard}from"./DefaultCard";import{DefaultSimpleCard}from"./DefaultSimpleCard";import{GitHubCard}from"./GitHubCard";import{GroupCard}from"./GroupCard";import{GroupMembersCard}from"./GroupMembersCard";import{IdentityCardHeaderElement as HeaderElement}from"./IdentityCardHeaderElement";import*as Utils from"./IdentityCardIdentityUtils";import{OrganizationCard}from"./OrganizationCard";var IdentityCardContent=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onKeyDown=function(t){27===t.which&&(e.onDismissCallout(),t.preventDefault())},e.onDismissCallout=function(){e.props.onDismissCallback&&e.props.onDismissCallback()},e}return tslib_1.__extends(e,t),e.prototype.render=function(){var t=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return React.createElement("div",null,React.createElement(Callout,{onDismiss:this.onDismissCallout,anchorElement:t,anchorOrigin:{horizontal:"end",vertical:"start"},calloutOrigin:{horizontal:"start",vertical:"start"},ariaLabel:Resources.IdentityCardProfileCardAriaLabel,role:"alert",className:"bolt-identity-card-callout depth-8",lightDismiss:!0},React.createElement("div",null,this.renderCard())))},e.prototype.renderCard=function(){if(this.props.working&&!Utils.isCompleteIdentity(this.props.dataProps.identity))return React.createElement("div",{className:css("bolt-identity-card","loading")},React.createElement(Spinner,{label:Resources.Loading,size:"large",className:"bolt-identity-card-loading-spinner"}));var t=Utils.isAdUser(this.props.dataProps.identity)||Utils.isAadUser(this.props.dataProps.identity)||Utils.isGroup(this.props.dataProps.identity),e=this.props.dataProps.header||void 0,r=this.renderInnerCard();return r?React.createElement(FocusZone,{circularNavigation:!0,direction:2,focusOnMount:!0,handleTabKey:!0},React.createElement("div",{className:"bolt-identity-card",onKeyDown:this.onKeyDown},t&&e&&React.createElement(HeaderElement,{identity:e,onClickFunction:this.props.onHeaderClick}),r)):React.createElement("div",null)},e.prototype.renderInnerCard=function(){var t=this.props.dataProps,e=t.identity,r=t.successors,i=t.managerList,a=t.directReportList;if(!e)return React.createElement("div",null);var o=Utils.isGroup(e),n=Utils.isVsdUser(e),s=Utils.isWmdUser(e),d=Utils.isAadUser(e),l=Utils.isAdUser(e),p=Utils.isGithubUser(e);if(o)switch(this.props.dataProps.cardType){case 2:return React.createElement(GroupMembersCard,{identity:e,members:r,onClickEntity:this.props.onClickEntity});case 0:return React.createElement(GroupCard,{identity:e,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,members:r,showOrganizationCard:this.props.onShowOrganizationCard})}else{if(p)return React.createElement(GitHubCard,{identity:e});if(n)return React.createElement(DefaultAbridgedCard,{identity:e});if(s)return React.createElement(DefaultSimpleCard,{identity:e});if(d||l)switch(this.props.dataProps.cardType){case 1:return React.createElement(ContactCard,{identity:e});case 2:return React.createElement(OrganizationCard,{identity:e,managerList:i,directReportList:a,onClickEntity:this.props.onClickEntity});case 0:default:var c=i&&i.length>0?i[i.length-1]:void 0;return React.createElement(DefaultCard,{identity:e,manager:c,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity})}}return React.createElement("div",null)},e}(React.Component);export{IdentityCardContent};