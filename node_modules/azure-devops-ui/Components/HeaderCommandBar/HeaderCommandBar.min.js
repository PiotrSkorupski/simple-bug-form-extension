import*as tslib_1 from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./HeaderCommandBar.css";import*as React from"react";import{Button}from"../../Button";import{MenuButton,MoreButton}from"../../Menu";import{css}from"../../Util";import{FILTER_CHANGE_EVENT}from"../../Utilities/Filter";import{ObservableArray}from"../../Core/Observable";import{CustomHeaderCommandBar}from"./CustomHeaderCommandBar";import{getFilterItem}from"./Items";var headerCommandBarId=1,HeaderCommandBar=function(e){function t(t){var r=e.call(this,t)||this;return r.menuButtonId="header-command-bar-menu-button"+headerCommandBarId++,r}return tslib_1.__extends(t,e),t.prototype.render=function(){for(var e=this.props.items,t=[],r=[],o=3-e.filter(function(e){return!0===e.important}).length,n=!1,a=0;a<e.length;a++){var i=e[a];i.important?(n=!(!i.iconProps||i.text),t.push(i)):o>0&&void 0===i.important?(o--,n=!(!i.iconProps||i.text),t.push(i)):r.push(i)}var s=t.length+(r.length>0?1:0);n=n||r.length>0;var m=React.createElement(React.Fragment,null,t.map(function(e,t){var r=e.id,o={ariaLabel:e.ariaLabel,ariaPosInSet:t+1,ariaSetSize:s,className:css(e.className,"bolt-header-command-item-button"),disabled:e.disabled,href:e.href,iconProps:e.iconProps&&{iconName:e.iconProps.iconName},id:r,primary:e.isPrimary,role:e.role||"menuitem",subtle:e.subtle,target:e.target,text:e.text,tooltipProps:e.tooltipProps},n=Button;return e.subMenuProps?(o.contextualMenuProps={menuProps:e.subMenuProps},o.hideDropdownIcon=e.hideDropdownIcon,n=MenuButton):o.onClick=function(t){return e.onActivate&&e.onActivate(e,t)},React.createElement(n,tslib_1.__assign({},o,{key:r}))}),r.length>0&&React.createElement(MoreButton,{ariaPosInSet:t.length+1,ariaSetSize:s,className:"bolt-header-command-item-button",contextualMenuProps:{menuProps:{id:"header-submenu",items:new ObservableArray(r)}},id:this.menuButtonId,role:"menuitem"}));return e.length>0?React.createElement(CustomHeaderCommandBar,{className:this.props.className,focusGroupProps:{defaultElementId:t.length?t[0].id:this.menuButtonId},lastItemIsIconButton:!0,role:t.length&&"button"===t[0].role?void 0:"menubar"},m):null},t}(React.Component);export{HeaderCommandBar};var HeaderCommandBarWithFilter=function(e){function t(t){var r=e.call(this,t)||this;return r.onFilterClicked=function(){r.props.filterToggled.value=!r.props.filterToggled.value},r.onFilterChanged=function(){var e=r.props.filter.hasChangesToReset();e!==r.state.filterHasChanges&&r.setState({filterHasChanges:e})},r.state={filterHasChanges:r.props.filter.hasChangesToReset()},r}return tslib_1.__extends(t,e),t.prototype.componentDidMount=function(){this.props.filter.subscribe(this.onFilterChanged,FILTER_CHANGE_EVENT)},t.prototype.componentWillUnmount=function(){this.props.filter.unsubscribe(this.onFilterChanged,FILTER_CHANGE_EVENT)},t.prototype.render=function(){var e=this.props.items?this.props.items.slice():[];return e.push(getFilterItem(this.onFilterClicked,this.state.filterHasChanges)),React.createElement(HeaderCommandBar,tslib_1.__assign({},this.props,{items:e}))},t}(React.Component);export{HeaderCommandBarWithFilter};