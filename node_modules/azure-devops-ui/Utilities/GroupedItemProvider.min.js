import{ObservableArray}from"../Core/Observable";var GroupedItemProvider=function(){function t(t,e,r){this.listItems=new ObservableArray,this.internalGroups=e.slice(),this.groupedItems=[[]];for(var s=0;s<this.internalGroups.length;s++)this.groupedItems.push([]);this.addItems(t),r&&this.addHeaders(1,this.groups.length),this.manageHeaders=!!r}return Object.defineProperty(t.prototype,"groups",{get:function(){return this.internalGroups},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.listItems.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.listItems.value},enumerable:!0,configurable:!0}),t.prototype.subscribe=function(t,e){this.listItems.subscribe(t,e)},t.prototype.unsubscribe=function(t,e){return this.listItems.unsubscribe(t,e)},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.addItems(t),t.length},t.prototype.pushGroups=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.addGroups.apply(this,[this.internalGroups.length].concat(t)),this.internalGroups.length},t.prototype.pop=function(){var t=this.listItems.pop();return t&&this.removeItems([t]),t},t.prototype.removeAll=function(t){var e=this.listItems.removeAll(t);return this.removeItems(e),e},t.prototype.splice=function(t,e){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];var i=this.listItems.splice(t,e);return this.removeItems(i,!1),this.addItems(r),i},t.prototype.spliceGroups=function(t,e){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];for(var i=0;i<e;i++){var o=t+i+1;if(this.groupedItems.length>o){if(this.removeItems(this.groupedItems[o].slice()),this.manageHeaders&&1===o&&!this.groupedItems[0].length&&this.groupedItems.length>2){var n=this.groupedItems[2].find(function(t){return 3===t.type});n&&this.removeItems([n])}this.groupedItems.splice(o,1)}}var p=this.internalGroups.splice(t,e);return this.addGroups.apply(this,[t].concat(r)),p},t.prototype.addHeaders=function(t,e){for(var r=0;r<e;r++){var s=this.groups[r+t-1];this.groupedItems[r+t].find(function(t){return 2===t.type})||this.addItems([{id:s.id+"-header",text:s.name,type:2,groupId:s.id}]),(t+r>1||this.groupedItems[0].length)&&!this.groupedItems[r+t].find(function(t){return 3===t.type})&&this.addItems([{id:s.id+"-divider",type:3,groupId:s.id}]),t+r===1&&this.groups.length>1&&!this.groupedItems[2].find(function(t){return 3===t.type})&&(s=this.groups[1],this.addItems([{id:s.id+"-divider",type:3,groupId:s.id}]))}},t.prototype.addGroups=function(t){for(var e,r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];(e=this.internalGroups).splice.apply(e,[t,0].concat(r));for(var i=[],o=0;o<r.length;o++){this.groupedItems.splice(t+o+1,0,[]);for(var n=0;n<this.groupedItems[0].length;n++)if(this.groupedItems[0][n].groupId===r[o].id){var p=this.groupedItems[0].splice(n,1)[0];this.listItems.splice(n,1),i.push(p)}}this.addItems(i),this.manageHeaders&&this.addHeaders(t+1,r.length)},t.prototype.addItems=function(t){for(var e=function(e){var s=0,i=0,o=t[e].groupId;void 0!==o&&(s=r.internalGroups.findIndex(function(t){return t.id===o})+1);for(var n=0;n<s;n++)i+=r.groupedItems[n].length;3===t[e].type?r.groupedItems[s].unshift(t[e]):2===t[e].type?r.groupedItems[s].length&&3===r.groupedItems[s][0].type?(r.groupedItems[s].splice(1,0,t[e]),i++):r.groupedItems[s].unshift(t[e]):(i+=r.groupedItems[s].length,r.groupedItems[s].push(t[e])),r.listItems.splice(i,0,t[e])},r=this,s=0;s<t.length;s++)e(s)},t.prototype.removeItems=function(t,e){void 0===e&&(e=!0);for(var r=function(r){var i=0,o=0,n=t[r].groupId;void 0!==n&&(i=s.internalGroups.findIndex(function(t){return t.id===n})+1);for(var p=0;p<i;p++)o+=s.groupedItems[p].length;var u=s.groupedItems[i],d=u.indexOf(t[r]);u.splice(d,1),e&&s.listItems.splice(o+d,1)},s=this,i=0;i<t.length;i++)r(i)},t}();export{GroupedItemProvider};